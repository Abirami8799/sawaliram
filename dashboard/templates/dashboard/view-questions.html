{% extends "dashboard/base.html" %}

{% block title %} View Questions | Sawaliram {% endblock %}

{% block content %}

<h1 class="task-heading">View Questions</h1>

<h2 class="task-sub-heading">View questions and related information - filtered by language or state.</h2>

<hr class="task-hr">

<div class="filter-area">
    <div id="filterForm">
        <form action="{% url 'dashboard:view-questions-view' %}" method="GET">

            <div class="form-group">
                <label class="filter-form-section-label">Filter States</label><br>
                {% for state in states_list %}
                <div class="form-check form-check-inline">
                    <input type="checkbox" class="form-check-input" name="states" value="{{ state.state }}" id="statesOption{{ forloop.counter }}" {% if state.state in states_to_filter_by %} checked {% endif %}>
                    <label for="statesOption{{ forloop.counter }}" class="form-check-label">
                        {{ state.state|capfirst }}
                    </label>
                </div>
                {% endfor %}
            </div>

            <div class="form-group">
                <label class="filter-form-section-label">Filter Languages</label><br>
                {% for language in languages_list %}
                <div class="form-check form-check-inline">
                    <input type="checkbox" class="form-check-input" name="languages" value="{{ language.question_language }}" id="languagesOption{{ forloop.counter }}" {% if language.question_language in languages_to_filter_by %} checked {% endif %}>
                    <label for="languagesOption{{ forloop.counter }}" class="form-check-label">
                        {{ language.question_language|capfirst }}
                    </label>
                </div>
                {% endfor %}
            </div>

            <button type="submit" class="btn btn-dark btn-sm">Apply Filters</button>

        </form>
    </div>
</div>

<div id="questionsList">
    {% if questions %}
    {% for question in questions %}
    <div class="card">

        <div class="card-header" id="questionCard{{ forloop.counter }}">
            <h3>
                {{ question.question_text }}
            </h3>
        </div>

        <div class="card-body">
            {% if question.school or question.state or question.area %}
            <div class="row">
                <div class="col-12 col-sm-4">
                    <i class="fas fa-graduation-cap"></i>
                    <span class="meta-value">
                    {% if question.school %}
                        {{ question.school }}
                        {% if question.curriculum_followed %}
                        ({{ question.curriculum_followed }})
                        {% endif %}
                    {% else %}
                        NA
                    {% endif %}
                    </span>
                </div>
                <div class="col-12 col-sm-4">
                    <i class="fas fa-map-marker-alt"></i>
                    <span class="meta-value">
                        {% if question.area %}
                            {{ question.area.rstrip }}{% endif %}{% if question.state %}, {{ question.state }}
                        {% elif question.state %}
                            {{ question.state }}
                        {% else %}
                            Location details not available
                        {% endif %}
                    </span>
                </div>
                {% if question.question_asked_on %}
                <div class="col-12 col-sm-4 meta-date-column">
                    <i class="far fa-calendar-alt"></i>
                    <span class="meta-value">
                        {{ question.question_asked_on }}
                    </span>
                </div>
                {% endif %}
            </div>
            {% endif %}

            {% if question.question_format %}
            <p class="meta-phrase-section">
                This question was <span class="meta-value">{{ question.question_format|lower }}</span>,{% if question.question_language %} in <span class="meta-value">{{ question.question_language }}</span>.{% endif %}
            </p>
            {% elif question.question_language %}
            <p class="meta-phrase-section">
                This question was asked in <span class="meta-value">{{ question.question_language }}</span>.
            </p>
            {% endif %}

            {% if question.question_text_english %}
            <p class="meta-phrase-section">
                English translation: "<span class="meta-value">{{ question.question_text_english }}</span>".
            </p>
            {% endif %}

            {% if question.contributor %}
            <p class="meta-phrase-section">
                Collected by: <span class="meta-value">{{ question.contributor }} {% if question.contributor_role %}({{ question.contributor_role }}){% endif %}</span>
            </p>
            {% endif %}
        </div>

    </div>
    {% endfor %}
    {% else %}
        <p class="empty-result-text">No questions found. Try changing the filters.</p>
    {% endif %}
</div>

{% endblock %}